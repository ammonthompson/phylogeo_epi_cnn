<beast version='2.0' namespace='master:master.model:master.steppers:master.conditions:master.postprocessors:master.outputs'>

<run spec='InheritanceEnsemble'
		verbosity='1'
		nTraj='1'
		nSamples="10000" samplePopulationSizes="true" 
		simulationTime='19.6496100000'
		maxConditionRejects='1'>

<model spec='Model'>
	<populationType spec='PopulationType' typeName='S' id='S' dim='3'/>
 	<populationType spec='PopulationType' typeName='I' id='I' dim='3'/>
	<populationType spec='PopulationType' typeName='D' id='D'/>
	<populationType spec='PopulationType' typeName='R' id='R'/>

	<populationType spec='PopulationType' typeName='M_into_0' id='M_into_0' dim='3'/>
	<populationType spec='PopulationType' typeName='M_into_1' id='M_into_1' dim='3'/>
	<populationType spec='PopulationType' typeName='M_into_2' id='M_into_2' dim='3'/>

<reactionGroup spec='ReactionGroup' reactionGroupName='Infection'>
 <reaction spec='Reaction' reactionName="Infection" rate="0.000026095715"> 
 	S[0] + I[0]:1 -> 2I[0]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.000026095715"> 
 	S[1] + I[1]:1 -> 2I[1]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.000026095715"> 
 	S[2] + I[2]:1 -> 2I[2]:1 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Migration'>
<reaction spec='Reaction' reactionName="Migration" rate="0.00378"> 
 	I[0] -> I[1] + M_into_1[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00378"> 
 	I[0] -> I[2] + M_into_2[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00378"> 
 	I[1] -> I[0] + M_into_0[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00378"> 
 	I[1] -> I[2] + M_into_2[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00378"> 
 	I[2] -> I[0] + M_into_0[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00378"> 
 	I[2] -> I[1] + M_into_1[2] 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Sample_recovery'>
<reaction spec='Reaction' reactionName="Sample_recovery" rate=".00486,1000:19.64960,0:19.6496100000"> 
 	I[0] -> R + D 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate=".00486,1000:19.64960,0:19.6496100000"> 
 	I[1] -> R + D 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate=".00486,1000:19.64960,0:19.6496100000"> 
 	I[2] -> R + D 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Recovery'>
<reaction spec='Reaction' reactionName="Recovery" rate=".04597"> 
 	I[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate=".04597"> 
 	I[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate=".04597"> 
 	I[2] -> R 
 </reaction>
</reactionGroup>
</model>

<initialState spec='InitState'>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="0"/>
</populationSize>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="1"/>
</populationSize>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="2"/>
</populationSize>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='0'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='1' >
	<population spec='Population' type='@I' location='1'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='2'/>
</lineageSeedMultiple>
</initialState>

<lineageEndCondition spec='LineageEndCondition' 
 nLineages="100000" alsoGreaterThan="true" isRejection="false"/>
<lineageEndCondition spec='LineageEndCondition'
 nLineages="0" alsoGreaterThan="false" isRejection="false">
	<population spec='Population' type='@I' location="0"/>
	<population spec='Population' type='@I' location="1"/>
	<population spec='Population' type='@I' location="2"/>
</lineageEndCondition>

<inheritancePostProcessor spec='LineageFilter' 
 reactionName="Sample_recovery" 
 reverseTime="false" 
 discard="false" 
 leavesOnly="false" 
 noClean="false" />

<inheritancePostProcessor spec='LineageSampler' 
 nSamples="6" />

<postSimCondition spec='LeafCountPostSimCondition' 
 nLeaves="5" 
 exact="false" 
 exceedCondition="true"/>

<output spec='NewickOutput' collapseSingleChildNodes="true" fileName="/mnt/c/Users/ammon_work/Desktop/RESEARCH_PROJECTS/phylogeo_epi_cnn/TESTING/mytest_sim19.newick" />
<output spec='NexusOutput' fileName="/mnt/c/Users/ammon_work/Desktop/RESEARCH_PROJECTS/phylogeo_epi_cnn/TESTING/mytest_sim19.nexus" />
<output spec='JsonOutput' fileName="/mnt/c/Users/ammon_work/Desktop/RESEARCH_PROJECTS/phylogeo_epi_cnn/TESTING/mytest_sim19.json" />
</run>
</beast>
