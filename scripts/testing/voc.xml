<beast version='2.0' namespace='master:master.model:master.steppers:master.conditions:master.postprocessors:master.outputs'>

<run spec='InheritanceEnsemble'
		verbosity='1'
		nTraj='20'
		samplePopulationSizes="true" 
		simulationTime='1'
		maxConditionRejects='1000'>

<model spec='Model'>
	<populationType spec='PopulationType' typeName='S' id='S' dim='5'/>
 	<populationType spec='PopulationType' typeName='I' id='I' dim='5'/>
 	<populationType spec='PopulationType' typeName='V' id='V' dim='5'/>
	<populationType spec='PopulationType' typeName='R' id='R'/>
	<populationType spec='PopulationType' typeName='C' id='C'/>


<reactionGroup spec='ReactionGroup' reactionGroupName='Infection'>
 <reaction spec='Reaction' reactionName="Infection" rate="0.002"> 
 	S[0] + I[0]:1 -> 2I[0]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.002"> 
 	S[1] + I[1]:1 -> 2I[1]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.002"> 
 	S[2] + I[2]:1 -> 2I[2]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.002"> 
 	S[3] + I[3]:1 -> 2I[3]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.002"> 
 	S[4] + I[4]:1 -> 2I[4]:1 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Mutation'>
 <reaction spec='Reaction' reactionName="Mutation" rate="0.0002"> 
 	I[0]:1 -> V[0]:1 + C 
 </reaction>
 <reaction spec='Reaction' reactionName="Mutation" rate="0.0002"> 
 	I[1]:1 -> V[1]:1 + C 
 </reaction>
 <reaction spec='Reaction' reactionName="Mutation" rate="0.0002"> 
 	I[2]:1 -> V[2]:1 + C 
 </reaction>
 <reaction spec='Reaction' reactionName="Mutation" rate="0.0002"> 
 	I[3]:1 -> V[3]:1 + C 
 </reaction>
 <reaction spec='Reaction' reactionName="Mutation" rate="0.0002"> 
 	I[4]:1 -> V[4]:1 + C 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='VocInfection'>
 <reaction spec='Reaction' reactionName="VocInfection" rate="0.008"> 
 	S[0] + V[0]:1 -> 2V[0]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="VocInfection" rate="0.008"> 
 	S[1] + V[1]:1 -> 2V[1]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="VocInfection" rate="0.008"> 
 	S[2] + V[2]:1 -> 2V[2]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="VocInfection" rate="0.008"> 
 	S[3] + V[3]:1 -> 2V[3]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="VocInfection" rate="0.008"> 
 	S[4] + V[4]:1 -> 2V[4]:1 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Migration'>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	I[0] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	V[0] -> V[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	I[0] -> I[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	V[0] -> V[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	I[0] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	V[0] -> V[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00486683"> 
 	I[0] -> I[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00486683"> 
 	V[0] -> V[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	I[1] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	V[1] -> V[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	I[1] -> I[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	V[1] -> V[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	I[1] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	V[1] -> V[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00730025"> 
 	I[1] -> I[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00730025"> 
 	V[1] -> V[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	I[2] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	V[2] -> V[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	I[2] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	V[2] -> V[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	I[2] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	V[2] -> V[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	I[2] -> I[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	V[2] -> V[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	I[3] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	V[3] -> V[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	I[3] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	V[3] -> V[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	I[3] -> I[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.0146005"> 
 	V[3] -> V[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	I[3] -> I[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	V[3] -> V[4] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00486683"> 
 	I[4] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00486683"> 
 	V[4] -> V[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00730025"> 
 	I[4] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00730025"> 
 	V[4] -> V[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	I[4] -> I[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.00652954"> 
 	V[4] -> V[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	I[4] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.01032411"> 
 	V[4] -> V[3] 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Sample_recovery'>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.1"> 
 	I[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.1"> 
 	V[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.1"> 
 	I[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.1"> 
 	V[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	I[2] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	V[2] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	I[3] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	V[3] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	I[4] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	V[4] -> R 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Recovery'>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	V[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	V[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[2] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	V[2] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[3] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	V[3] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[4] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	V[4] -> R 
 </reaction>
</reactionGroup>
</model>

<initialState spec='InitState'>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="0"/>
</populationSize>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="1"/>
</populationSize>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="2"/>
</populationSize>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="3"/>
</populationSize>
<populationSize spec='PopulationSize' size='10000'>
	 <population spec='Population' type='@S' location="4"/>
</populationSize>
<lineageSeedMultiple spec='MultipleIndividuals' copies='1' >
	<population spec='Population' type='@I' location='0'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='1'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='2'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='3'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='4'/>
</lineageSeedMultiple>
</initialState>

<lineageEndCondition spec='LineageEndCondition' 
 nLineages="50000" alsoGreaterThan="true" isRejection="false"/>
<lineageEndCondition spec='LineageEndCondition'
 nLineages="0" alsoGreaterThan="false" isRejection="false">
	<population spec='Population' type='@I' location="0"/>
	<population spec='Population' type='@I' location="1"/>
	<population spec='Population' type='@I' location="2"/>
	<population spec='Population' type='@I' location="3"/>
	<population spec='Population' type='@I' location="4"/>
</lineageEndCondition>

<inheritancePostProcessor spec='LineageFilter' 
 reactionName="Sample_recovery" 
 reverseTime="false" 
 discard="false" 
 leavesOnly="false" 
 noClean="false" />

<inheritancePostProcessor spec='LineageSampler' 
 nSamples="5000" />

<postSimCondition spec='LeafCountPostSimCondition' 
 nLeaves="100" 
 exact="false" 
 exceedCondition="true"/>

<postSimCondition spec='LeafCountPostSimCondition' 
 nLeaves="1" 
 exact="false" 
 exceedCondition="true">
	<population spec='Population' type='@V' />
</postSimCondition>

<populationEndCondition spec='PopulationEndCondition' 
 threshold="2" 
 isRejection="true" 
 exceedCondition="true">
	<population spec='Population' type='@C' />
</populationEndCondition>

<output spec='NewickOutput' collapseSingleChildNodes="true" fileName="voc.newick" />
<output spec='NexusOutput' fileName="voc.nexus" />
<output spec='JsonOutput' fileName="voc.json" />
</run>
</beast>
