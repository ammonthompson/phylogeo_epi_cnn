<beast version='2.0' namespace='master:master.model:master.steppers:master.conditions:master.postprocessors:master.outputs'>

<run spec='InheritanceEnsemble'
		verbosity='3'
		nTraj='1'
		samplePopulationSizes="true"
	        sampleAtNodesOnly="true"	
		simulationTime='10'
		maxConditionRejects='20'>

<model spec='Model'>
	<populationType spec='PopulationType' typeName='S' id='S' dim='4'/>
 	<populationType spec='PopulationType' typeName='I' id='I' dim='4'/>
	<populationType spec='PopulationType' typeName='R' id='R'/>


<reactionGroup spec='ReactionGroup' reactionGroupName='Infection'>
 <reaction spec='Reaction' reactionName="Infection" rate="0.0002"> 
 	S[0] + I[0]:1 -> 2I[0]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.0002"> 
 	S[1] + I[1]:1 -> 2I[1]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.0002"> 
 	S[2] + I[2]:1 -> 2I[2]:1 
 </reaction>
 <reaction spec='Reaction' reactionName="Infection" rate="0.0002"> 
 	S[3] + I[3]:1 -> 2I[3]:1 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Migration'>
<reaction spec='Reaction' reactionName="Migration" rate="2.45698231"> 
 	I[0] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="1.09879589"> 
 	I[0] -> I[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.21975918"> 
 	I[0] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="2.45698231"> 
 	I[1] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="1.73734886"> 
 	I[1] -> I[2] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.22812508"> 
 	I[1] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="1.09879589"> 
 	I[2] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="1.73734886"> 
 	I[2] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.25898868"> 
 	I[2] -> I[3] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.21975918"> 
 	I[3] -> I[0] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.22812508"> 
 	I[3] -> I[1] 
 </reaction>
<reaction spec='Reaction' reactionName="Migration" rate="0.25898868"> 
 	I[3] -> I[2] 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Sample_recovery'>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.1"> 
 	I[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	I[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	I[2] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Sample_recovery" rate="0.5"> 
 	I[3] -> R 
 </reaction>
</reactionGroup>

<reactionGroup spec='ReactionGroup' reactionGroupName='Recovery'>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[0] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[1] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[2] -> R 
 </reaction>
<reaction spec='Reaction' reactionName="Recovery" rate="10"> 
 	I[3] -> R 
 </reaction>
</reactionGroup>
</model>

<initialState spec='InitState'>
<populationSize spec='PopulationSize' size='100000'>
	 <population spec='Population' type='@S' location="0"/>
</populationSize>
<populationSize spec='PopulationSize' size='100000'>
	 <population spec='Population' type='@S' location="1"/>
</populationSize>
<populationSize spec='PopulationSize' size='100000'>
	 <population spec='Population' type='@S' location="2"/>
</populationSize>
<populationSize spec='PopulationSize' size='100000'>
	 <population spec='Population' type='@S' location="3"/>
</populationSize>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='0'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='1' >
	<population spec='Population' type='@I' location='1'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='2'/>
</lineageSeedMultiple>
<lineageSeedMultiple spec='MultipleIndividuals' copies='0' >
	<population spec='Population' type='@I' location='3'/>
</lineageSeedMultiple>
</initialState>

<lineageEndCondition spec='LineageEndCondition' 
 nLineages="50000" alsoGreaterThan="true" isRejection="false"/>
<lineageEndCondition spec='LineageEndCondition'
 nLineages="0" alsoGreaterThan="false" isRejection="false">
	<population spec='Population' type='@I' location="0"/>
	<population spec='Population' type='@I' location="1"/>
	<population spec='Population' type='@I' location="2"/>
	<population spec='Population' type='@I' location="3"/>
</lineageEndCondition>

<inheritancePostProcessor spec='LineageFilter' 
 reactionName="Sample_recovery" 
 reverseTime="false" 
 discard="false" 
 leavesOnly="false" 
 noClean="false" />

<inheritancePostProcessor spec='LineageSampler' 
 nSamples="300" />

<postSimCondition spec='LeafCountPostSimCondition' 
 nLeaves="5" 
 exact="false" 
 exceedCondition="true"/>

<output spec='NewickOutput' fileName="mytest.newick" />
<output spec='NexusOutput' fileName="mytest.nexus" />
<output spec='JsonOutput' fileName="mytest.json" />
</run>
</beast>
