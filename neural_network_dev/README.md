# Neural Network Development for Phylogeographic and Epidemiological Models

This repository focuses on training neural networks to predict various parameters and states for phylogeographic and epidemiological models. There are specific training notebooks for different types of predictors and models.

## Directory Structure

### Main Scripts and Notebooks

- `test_extant.ipynb`: Notebook for testing rates predictors for the simple SIR model with test data generated by correct and misspecified model.
- `train_extant_rates.ipynb`: Notebook for training rates predictors for the simple SIR model.
- `train_mtbd_rates.ipynb`: Notebook for training rates predictors for Multi-type birth-death SIR models.
- `test_mtbd_real_data_analysis.ipynb`:
- `train_extant_root_location.ipynb`: Notebook for training root state predictors for the simple SIR model.
- `train_mtbd_root_location.ipynb`: Notebook for training root state predictors for Multi-type birth-death SIR models.
- `cnn_utilities.py`: Utility functions for the CNN training and testing.

### Data Files

The `data_files` directory contains various data files necessary for training and testing the neural networks. Some of the key files include:
- Training sets, parameter values, and labels for the simple SIR and Multi-type birth-death SIR models.
- Postmeans and root probabilities.

### Output

The `output` directory holds various output files generated after running scripts and notebooks. This includes predictions, labels, phylo means, and other analysis-related outputs.

### Saved Models

Trained neural network models and related files are saved in the `saved_models` directory. This allows for easy retrieval and application of the models in various analyses.

### UQ and Adequacy

The `uq_and_adequacy` directory focuses on uncertainty quantification and model adequacy. It contains:
- Several Jupyter notebooks (`cqr_uq_extant.ipynb`, `cqr_uq_mtbd.ipynb`, etc.)
- Utility scripts for UQ.
- A dedicated data_files directory and an output directory.

## Training Notes

There are 4 different training notebooks:
1. A rates predictor for the simple SIR model.
2. A root state predictor for the simple SIR model.
3. A rates predictor for Multi-type birth-death SIR models.
4. A root state predictor for Multi-type birth-death SIR models.

## Getting Started

1. Start by opening the desired Jupyter notebook (`*.ipynb` file).
2. Ensure all required data files are in the `data_files` directory.
3. Follow the instructions in the notebook for training or testing.
4. Once complete, trained models can be found in the `saved_models` directory and outputs in the `output` directory.

